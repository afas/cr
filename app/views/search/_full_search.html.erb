<div class="full-search">
  <div class="rooms">
    <label for="rooms_count">Комнат</label><br/>
    <%= collection_select(:flat, :rooms_count, RoomCount.collection, :cut, :name, :prompt => true) %>
  </div>

  <div class="rent_period">
    <label for="rent_period">Срок аренды</label><br/>
    <%= collection_select(:flat, :rent_period, RentPeriod.collection, :cut, :name, :prompt => true) %>
  </div>

  <div class="prepayment">
    <label for="prepayment">Предоплата</label><br/>
    <%= collection_select(:flat, :prepayment, Prepayment.collection, :cut, :name, :prompt => true) %>
  </div>

  <div class="metro">
    <label for="metro">Метро</label><br/>
    <input type="text" name="metro" placeholder="Баррикадная" value="">
  </div>

  <div class="address">
    <label for="address">Улица</label><br/>
    <input type="text" name="address" placeholder="" value="">
  </div>

  <div class="balkon">
    <label for="balkon">Балкон</label><br/>
    <%= collection_select(:flat, :balkon, Balkon.collection, :cut, :name, :prompt => true) %>
  </div>

  <div class="living_space">
    <label for="living_space">Площадь</label><br/>
    <input type="text" name="living_space" placeholder="" value="">
  </div>

  <div class="price">
    <label for="price">Цена</label><br/>
    <input type="text" name="price_from" placeholder="от" value="" size="6">
    <input type="text" name="price_to" placeholder="до" value="" size="6">
  </div>

  <br/>
  <input type="submit" value="Показать на карте" class="q-search-submit" onclick="searchFullResults()"></input>
  <br/>
  <input type="submit" value="Показать списком" class="q-search-submit" onclick="searchResultsList()"></input>
</div>

<script type="text/javascript">
    function searchFullResults() {
        var params = ""
        flat_rooms_count = $("#flat_rooms_count").val();
        if (flat_rooms_count) {
            if (params != "") {
                params = params + "&flat_rooms_count=" + flat_rooms_count
            } else {
                params = params + "flat_rooms_count=" + flat_rooms_count
            }
        }

        if (params != "") {

            $(".full-search").html("<img src='/search-preloader.gif'/>");

            $.get('/search.json/?' + params, function(newItemData) {
                Gmaps.map.replaceMarkers(newItemData);
            });
        }
    }
    function searchResults() {
        var params = ""
        flat_rooms_count = $("#flat_rooms_count").val();
        if (flat_rooms_count) {
            if (params != "") {
                params = params + "&flat_rooms_count=" + flat_rooms_count
            } else {
                params = params + "flat_rooms_count=" + flat_rooms_count
            }
        }

        if (params != "") {
            $.get('/search.json/?' + params, function(newItemData) {
                Gmaps.map.replaceMarkers(newItemData);
            });
        }
    }
    function searchResultsList() {
        window.locate("/flats")
    }
</script>

